module.exports=[24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},12479,a=>{"use strict";var b=a.i(37936),c=a.i(66518),d=a.i(18558),e=a.i(24868),f=a.i(14747),g=a.i(9307);async function h(a){let b=await (0,g.getSession)();if(console.log("[Upload Asset] Session:",JSON.stringify(b)),!b)return console.error("[Upload Asset] No session found"),{error:"Unauthorized: Please login again"};if("ADMIN"!==b.role)return console.error("[Upload Asset] Invalid role:",b.role),{error:`Unauthorized: You need ADMIN role. Current role: ${b.role}. Please logout and login again.`};let h=a.get("file"),i=a.get("name"),j=a.get("type");if(!h||!i||!j)return{error:"Missing fields"};try{let a=await h.arrayBuffer(),b=Buffer.from(a),g=`${Date.now()}-${h.name.replace(/\s/g,"_")}`,k=f.default.join(process.cwd(),"public/uploads",j.toLowerCase()),l=f.default.join(k,g);await (0,e.writeFile)(l,b);let m=`/uploads/${j.toLowerCase()}/${g}`;return await c.prisma.globalAsset.create({data:{name:i,type:j,url:m}}),(0,d.revalidatePath)("/admin/assets"),{success:!0}}catch(a){return console.error("Upload Error:",a),{error:"Failed to upload file"}}}(0,a.i(13095).ensureServerEntryExports)([h]),(0,b.registerServerReference)(h,"401959434edc0e25c692a6cd8ee0d3f24f4c10ba0d",null),a.s([],67107),a.i(67107),a.s(["401959434edc0e25c692a6cd8ee0d3f24f4c10ba0d",()=>h],12479)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1f46f12f._.js.map